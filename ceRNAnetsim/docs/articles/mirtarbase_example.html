<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An TCGA dataset application • ceRNAnetsim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An TCGA dataset application">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ceRNAnetsim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/convenient_iteration.html">An Offer: How to Find the Appropriate Iteration for Simulation</a>
    </li>
    <li>
      <a href="../articles/mirtarbase_example.html">An TCGA dataset application</a>
    </li>
    <li>
      <a href="../articles/perturbation_sample.html">How to Determine Perturbation in A Sample Dataset</a>
    </li>
    <li>
      <a href="../articles/realexample.html">Approach in A Real Dataset</a>
    </li>
    <li>
      <a href="../articles/small_sample.html">Approach of the Method in A Small Sample</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/selcenari/ceRNAnetsim">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An TCGA dataset application</h1>
                        <h4 class="author">Selcen Ari</h4>
            
            <h4 class="date">2019-04-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/selcenari/ceRNAnetsim/blob/master/vignettes/mirtarbase_example.Rmd"><code>vignettes/mirtarbase_example.Rmd</code></a></small>
      <div class="hidden name"><code>mirtarbase_example.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette is about the integration of gene miRNA pairs and their expression dataset and analysis. Let’s try to analysis of these dataset with <code>ceRNAnetsim</code>. First of all, obtain the datasets for analysis:</p>
<ul>
<li>The homo sapiens miRNA:target dataset is obtained via directly downloading from miRTarBase website. The dataset that is found in the working directory is processed as following:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install ceRNAnetsim</span>

<span class="co">#install.packages("devtools")</span>
<span class="co">#devtools::install_github("selcenari/ceRNAnetsim")</span>


<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ceRNAnetsim)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'ceRNAnetsim'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     simulate</span></code></pre></div>
<p>NOTE that if the mirna:target dataset includes miRNA genes as targets, the priming_graph() function can get fail. Because, the function define to miRNAs and targets without distinguishing between uppercase or lowercase.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"mirtarbasegene"</span>)

<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(mirtarbasegene)
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   miRNA           Target </span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;  </span>
<span class="co">#&gt; 1 hsa-miR-20a-5p  HIF1A  </span>
<span class="co">#&gt; 2 hsa-miR-146a-5p CXCR4  </span>
<span class="co">#&gt; 3 hsa-miR-122-5p  CYP7A1 </span>
<span class="co">#&gt; 4 hsa-miR-222-3p  STAT5A </span>
<span class="co">#&gt; 5 hsa-miR-21-5p   RASGRP1</span>
<span class="co">#&gt; 6 hsa-miR-148a-3p DNMT1</span></code></pre></div>
<ul>
<li>The gene and mirna expression counts of patient barcoded with TCGA-E9-A1N5 is obtained via <code>TCGAbiolinks</code> package from <code>Bioconductor</code>. The instructions of <code>TCGAbiolinks</code> can be followed. (For this step an other method (package) can be used.)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"TCGA_E9_A1N5_normal"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(TCGA_E9_A1N5_normal)
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt;   patient sample barcode definition ensembl_gene_id external_gene_n~</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;           </span>
<span class="co">#&gt; 1 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000003 TSPAN6          </span>
<span class="co">#&gt; 2 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000005 TNMD            </span>
<span class="co">#&gt; 3 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000419 DPM1            </span>
<span class="co">#&gt; 4 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000457 SCYL3           </span>
<span class="co">#&gt; 5 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000460 C1orf112        </span>
<span class="co">#&gt; 6 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000938 FGR             </span>
<span class="co">#&gt; # ... with 1 more variable: gene_expression &lt;dbl&gt;</span>


<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"TCGA_E9_A1N5_tumor"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(TCGA_E9_A1N5_tumor)
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt;   patient sample barcode definition ensembl_gene_id external_gene_n~</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;           </span>
<span class="co">#&gt; 1 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000003 TSPAN6          </span>
<span class="co">#&gt; 2 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000005 TNMD            </span>
<span class="co">#&gt; 3 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000419 DPM1            </span>
<span class="co">#&gt; 4 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000457 SCYL3           </span>
<span class="co">#&gt; 5 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000460 C1orf112        </span>
<span class="co">#&gt; 6 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000938 FGR             </span>
<span class="co">#&gt; # ... with 1 more variable: gene_expression &lt;dbl&gt;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"TCGA_E9_A1N5_mirnatumor"</span>)

<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(TCGA_E9_A1N5_mirnatumor)
<span class="co">#&gt; # A tibble: 6 x 6</span>
<span class="co">#&gt;   barcode             mirbase_ID   miRNA      Precusor total_read total_RPM</span>
<span class="co">#&gt;   &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 TCGA-E9-A1N5-01A-1~ MIMAT0000062 hsa-let-7~ MI00000~      45725  20802.  </span>
<span class="co">#&gt; 2 TCGA-E9-A1N5-01A-1~ MIMAT0004481 hsa-let-7~ MI00000~        100     45.5 </span>
<span class="co">#&gt; 3 TCGA-E9-A1N5-01A-1~ MIMAT0010195 hsa-let-7~ MI00000~          6      2.73</span>
<span class="co">#&gt; 4 TCGA-E9-A1N5-01A-1~ MIMAT0000063 hsa-let-7~ MI00000~      43489  19785.  </span>
<span class="co">#&gt; 5 TCGA-E9-A1N5-01A-1~ MIMAT0004482 hsa-let-7~ MI00000~        126     57.3 </span>
<span class="co">#&gt; 6 TCGA-E9-A1N5-01A-1~ MIMAT0000064 hsa-let-7~ MI00000~       2002    911.</span>

<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"TCGA_E9_A1N5_mirnanormal"</span>)

<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(TCGA_E9_A1N5_mirnanormal)
<span class="co">#&gt; # A tibble: 6 x 6</span>
<span class="co">#&gt;   barcode             mirbase_ID   miRNA      Precusor total_read total_RPM</span>
<span class="co">#&gt;   &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 TCGA-E9-A1N5-11A-4~ MIMAT0000062 hsa-let-7~ MI00000~      67599   37068. </span>
<span class="co">#&gt; 2 TCGA-E9-A1N5-11A-4~ MIMAT0004481 hsa-let-7~ MI00000~        132      72.4</span>
<span class="co">#&gt; 3 TCGA-E9-A1N5-11A-4~ MIMAT0010195 hsa-let-7~ MI00000~         57      31.3</span>
<span class="co">#&gt; 4 TCGA-E9-A1N5-11A-4~ MIMAT0000063 hsa-let-7~ MI00000~      47266   25918. </span>
<span class="co">#&gt; 5 TCGA-E9-A1N5-11A-4~ MIMAT0004482 hsa-let-7~ MI00000~        126      69.1</span>
<span class="co">#&gt; 6 TCGA-E9-A1N5-11A-4~ MIMAT0000064 hsa-let-7~ MI00000~      14554    7981.</span></code></pre></div>
<ul>
<li>All of these datasets are integrated. So, we obtains the miRNA:target dataset that contains miRNA and gene expression values.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
TCGA_E9_A1N5_mirnanormal<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(mirtarbasegene, <span class="dt">by=</span> <span class="st">"miRNA"</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(TCGA_E9_A1N5_normal, <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Target"</span>=<span class="st"> "external_gene_name"</span>))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Target, miRNA, total_read, gene_expression)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()-&gt;TCGA_E9_A1N5_mirnagene


TCGA_E9_A1N5_mirnagene<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Target)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gene_expression=</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(gene_expression))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>()-&gt;TCGA_E9_A1N5_mirnagene</code></pre></div>
<ul>
<li>We compare the two gene expression dataset of TCGA-E9A1N5 patient. So, we selected the gene which increased to 30 fold. (This gene node have been selected as an example.) Note that the selected node must be non-isolated one. If the isolated node selects, the system can not be affected from this distrubtion.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
TCGA_E9_A1N5_tumor<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(TCGA_E9_A1N5_normal, <span class="dt">by=</span> <span class="st">"external_gene_name"</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="dt">patient =</span> patient.x, external_gene_name, <span class="dt">tumor_exp =</span> gene_expression.x, <span class="dt">normal_exp =</span> gene_expression.y)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(TCGA_E9_A1N5_mirnagene, <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"external_gene_name"</span>=<span class="st"> "Target"</span>))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(tumor_exp <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>, normal_exp <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">FC=</span> tumor_exp<span class="op">/</span>normal_exp)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(FC))
<span class="co">#&gt; # A tibble: 132,268 x 8</span>
<span class="co">#&gt;    patient external_gene_n~ tumor_exp normal_exp miRNA total_read</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;                &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt;</span>
<span class="co">#&gt;  1 TCGA-E~ PVALB                  804          2 hsa-~       1963</span>
<span class="co">#&gt;  2 TCGA-E~ RIMS4                 8903         24 hsa-~          5</span>
<span class="co">#&gt;  3 TCGA-E~ RIMS4                 8903         24 hsa-~       4795</span>
<span class="co">#&gt;  4 TCGA-E~ RIMS4                 8903         24 hsa-~         56</span>
<span class="co">#&gt;  5 TCGA-E~ RIMS4                 8903         24 hsa-~         47</span>
<span class="co">#&gt;  6 TCGA-E~ RIMS4                 8903         24 hsa-~        994</span>
<span class="co">#&gt;  7 TCGA-E~ RIMS4                 8903         24 hsa-~         12</span>
<span class="co">#&gt;  8 TCGA-E~ RIMS4                 8903         24 hsa-~          8</span>
<span class="co">#&gt;  9 TCGA-E~ RIMS4                 8903         24 hsa-~         14</span>
<span class="co">#&gt; 10 TCGA-E~ RIMS4                 8903         24 hsa-~          1</span>
<span class="co">#&gt; # ... with 132,258 more rows, and 2 more variables: gene_expression &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FC &lt;dbl&gt;</span>

<span class="co">#HIST1H3H : non-isolated gene. 30 FC.</span></code></pre></div>
<p>The analysis is performed based on amounts of miRNAs and targets as seen. Firstly, we tried to find optimal iteration for the network when simulation start with <em>HIST1H3H</em> node.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/iteration_graph.html">iteration_graph</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(TCGA_E9_A1N5_mirnagene), <span class="dt">competing_count =</span> gene_expression, <span class="dt">miRNA_count =</span> total_read, <span class="dt">node_name =</span> <span class="st">"HIST1H3H"</span>, <span class="dt">.iter =</span> <span class="dv">10</span>, <span class="dt">how =</span> <span class="dv">30</span>)</code></pre></div>
<p><img src="mirtarbase_example_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The graph was shown that the change of HIST1H3H results in weak perturbation efficiency, although strong change. The results of the simulation was shown in following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(TCGA_E9_A1N5_mirnagene)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, <span class="dt">miRNA_count =</span> total_read)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/update_nodes.html">update_nodes</a></span>(<span class="dt">once =</span> <span class="ot">TRUE</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/update_how.html">update_how</a></span>(<span class="st">"HIST1H3H"</span>, <span class="dv">30</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/update_nodes.html">update_nodes</a></span>()<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/simulate.html">simulate</a></span>(<span class="dv">10</span>)
<span class="co">#&gt; Warning in priming_graph(., competing_count = gene_expression, miRNA_count = total_read): First variable processes as competing and the second as miRNA.</span>
<span class="co">#&gt; # A tbl_graph: 15216 nodes and 136797 edges</span>
<span class="co">#&gt; #</span>
<span class="co">#&gt; # A directed acyclic simple graph with 1 component</span>
<span class="co">#&gt; #</span>
<span class="co">#&gt; # Node Data: 15,216 x 7 (active)</span>
<span class="co">#&gt;   name  type  node_id initial_count count_pre count_current</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;         &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 CDK6  Comp~       1          4669     4669.         4669.</span>
<span class="co">#&gt; 2 MYC   Comp~       2         11593    11593.        11593.</span>
<span class="co">#&gt; 3 BCL2  Comp~       3          2445     2445.         2445.</span>
<span class="co">#&gt; 4 NKIR~ Comp~       4          1519     1519.         1519.</span>
<span class="co">#&gt; 5 ITGB3 Comp~       5           196      196.          196.</span>
<span class="co">#&gt; 6 NF2   Comp~       6          1755     1755.         1755.</span>
<span class="co">#&gt; # ... with 1.521e+04 more rows, and 1 more variable:</span>
<span class="co">#&gt; #   changes_variable &lt;chr&gt;</span>
<span class="co">#&gt; #</span>
<span class="co">#&gt; # Edge Data: 136,797 x 20</span>
<span class="co">#&gt;    from    to Competing_name miRNA_name gene_expression total_read dummy</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;                &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1 14473 CDK6           hsa-let-7~            4669      67599     1</span>
<span class="co">#&gt; 2     2 14473 MYC            hsa-let-7~           11593      67599     1</span>
<span class="co">#&gt; 3     3 14473 BCL2           hsa-let-7~            2445      67599     1</span>
<span class="co">#&gt; # ... with 1.368e+05 more rows, and 13 more variables: afff_factor &lt;dbl&gt;,</span>
<span class="co">#&gt; #   degg_factor &lt;dbl&gt;, comp_count_list &lt;list&gt;, comp_count_pre &lt;dbl&gt;,</span>
<span class="co">#&gt; #   comp_count_current &lt;dbl&gt;, mirna_count_list &lt;list&gt;,</span>
<span class="co">#&gt; #   mirna_count_pre &lt;int&gt;, mirna_count_current &lt;int&gt;,</span>
<span class="co">#&gt; #   mirna_count_per_dep &lt;dbl&gt;, effect_current &lt;dbl&gt;, effect_pre &lt;dbl&gt;,</span>
<span class="co">#&gt; #   effect_list &lt;list&gt;, mirna_count_per_comp &lt;dbl&gt;</span></code></pre></div>
<ul>
<li>And then, we tried to simulate the network with the gene which has higher expression amount. For this, we selected <em>ACTB</em> node as shown in following:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
TCGA_E9_A1N5_tumor<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(TCGA_E9_A1N5_normal, <span class="dt">by=</span> <span class="st">"external_gene_name"</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="dt">patient =</span> patient.x, external_gene_name, <span class="dt">tumor_exp =</span> gene_expression.x, <span class="dt">normal_exp =</span> gene_expression.y)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(TCGA_E9_A1N5_mirnagene, <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"external_gene_name"</span>=<span class="st"> "Target"</span>))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(tumor_exp <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>, normal_exp <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">FC=</span> tumor_exp<span class="op">/</span>normal_exp)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(normal_exp))
<span class="co">#&gt; # A tibble: 132,268 x 8</span>
<span class="co">#&gt;    patient external_gene_n~ tumor_exp normal_exp miRNA total_read</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;                &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt;</span>
<span class="co">#&gt;  1 TCGA-E~ COL1A1              582819     362641 hsa-~         42</span>
<span class="co">#&gt;  2 TCGA-E~ COL1A1              582819     362641 hsa-~         22</span>
<span class="co">#&gt;  3 TCGA-E~ COL1A1              582819     362641 hsa-~         10</span>
<span class="co">#&gt;  4 TCGA-E~ COL1A1              582819     362641 hsa-~      70463</span>
<span class="co">#&gt;  5 TCGA-E~ COL1A1              582819     362641 hsa-~         52</span>
<span class="co">#&gt;  6 TCGA-E~ COL1A1              582819     362641 hsa-~        806</span>
<span class="co">#&gt;  7 TCGA-E~ COL1A1              582819     362641 hsa-~         27</span>
<span class="co">#&gt;  8 TCGA-E~ COL1A1              582819     362641 hsa-~       1776</span>
<span class="co">#&gt;  9 TCGA-E~ COL1A1              582819     362641 hsa-~          3</span>
<span class="co">#&gt; 10 TCGA-E~ COL1A1              582819     362641 hsa-~          1</span>
<span class="co">#&gt; # ... with 132,258 more rows, and 2 more variables: gene_expression &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FC &lt;dbl&gt;</span>

<span class="co"># ACTB 1.87 fold</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/iteration_graph.html">iteration_graph</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(TCGA_E9_A1N5_mirnagene), <span class="dt">competing_count =</span> gene_expression, <span class="dt">miRNA_count =</span> total_read, <span class="dt">node_name =</span> <span class="st">"ACTB"</span>, <span class="dt">.iter =</span> <span class="dv">10</span>, <span class="dt">how =</span> <span class="fl">1.87</span>)</code></pre></div>
<p><img src="mirtarbase_example_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(TCGA_E9_A1N5_mirnagene)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, <span class="dt">miRNA_count =</span> total_read)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/update_nodes.html">update_nodes</a></span>(<span class="dt">once =</span> <span class="ot">TRUE</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/update_how.html">update_how</a></span>(<span class="st">"ACTB"</span>, <span class="fl">1.87</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/update_nodes.html">update_nodes</a></span>()<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/simulate.html">simulate</a></span>(<span class="dv">10</span>)
<span class="co">#&gt; Warning in priming_graph(., competing_count = gene_expression, miRNA_count = total_read): First variable processes as competing and the second as miRNA.</span>
<span class="co">#&gt; # A tbl_graph: 15216 nodes and 136797 edges</span>
<span class="co">#&gt; #</span>
<span class="co">#&gt; # A directed acyclic simple graph with 1 component</span>
<span class="co">#&gt; #</span>
<span class="co">#&gt; # Node Data: 15,216 x 7 (active)</span>
<span class="co">#&gt;   name  type  node_id initial_count count_pre count_current</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;         &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 CDK6  Comp~       1          4669     4678.         4678.</span>
<span class="co">#&gt; 2 MYC   Comp~       2         11593    11619.        11619.</span>
<span class="co">#&gt; 3 BCL2  Comp~       3          2445     2447.         2447.</span>
<span class="co">#&gt; 4 NKIR~ Comp~       4          1519     1524.         1524.</span>
<span class="co">#&gt; 5 ITGB3 Comp~       5           196      196.          196.</span>
<span class="co">#&gt; 6 NF2   Comp~       6          1755     1757.         1757.</span>
<span class="co">#&gt; # ... with 1.521e+04 more rows, and 1 more variable:</span>
<span class="co">#&gt; #   changes_variable &lt;chr&gt;</span>
<span class="co">#&gt; #</span>
<span class="co">#&gt; # Edge Data: 136,797 x 20</span>
<span class="co">#&gt;    from    to Competing_name miRNA_name gene_expression total_read dummy</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;                &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1 14473 CDK6           hsa-let-7~            4669      67599     1</span>
<span class="co">#&gt; 2     2 14473 MYC            hsa-let-7~           11593      67599     1</span>
<span class="co">#&gt; 3     3 14473 BCL2           hsa-let-7~            2445      67599     1</span>
<span class="co">#&gt; # ... with 1.368e+05 more rows, and 13 more variables: afff_factor &lt;dbl&gt;,</span>
<span class="co">#&gt; #   degg_factor &lt;dbl&gt;, comp_count_list &lt;list&gt;, comp_count_pre &lt;dbl&gt;,</span>
<span class="co">#&gt; #   comp_count_current &lt;dbl&gt;, mirna_count_list &lt;list&gt;,</span>
<span class="co">#&gt; #   mirna_count_pre &lt;int&gt;, mirna_count_current &lt;int&gt;,</span>
<span class="co">#&gt; #   mirna_count_per_dep &lt;dbl&gt;, effect_current &lt;dbl&gt;, effect_pre &lt;dbl&gt;,</span>
<span class="co">#&gt; #   effect_list &lt;list&gt;, mirna_count_per_comp &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="the-comparison-of-two-conditions" class="section level1">
<h1 class="hasAnchor">
<a href="#the-comparison-of-two-conditions" class="anchor"></a>The comparison of two conditions:</h1>
<ul>
<li><p>When the gene that has low expression level with high changing was used for perturbation of network, it displayed low efficiency with comparison to the gene which has low changing in higher expression level.</p></li>
<li><p>If the perturbed node has lower target:total target ratio in group or groups, the efficiency of it can be weak, or vice versa. The efficiency of ACTB gene may be high for this reason. But, ACTB has not strong perturbation efficiency too. This could be arisen from low miRNA:target ratio or impotent target nodes which have very low expression levels.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#the-comparison-of-two-conditions">The comparison of two conditions:</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Selcen Ari.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
